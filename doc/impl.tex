\documentclass{article}

\usepackage{amsmath}

\begin{document}

We first compute the $L^2$-Projection $\Pi_p \Phi_i \in \mathcal{P}_p( E )$
\begin{equation*}
  \int_E \Pi_p \Phi_i\,\varphi = \int_E \Phi\,\varphi
  \qquad\text{for all $\varphi \in \mathcal{P}_p( E )$.}
\end{equation*}

Using a basis $\phi_1, \ldots, \phi_{N_p}$ of $\mathcal{P}_p( E )$ and using
the representation
\begin{equation*}
  \Pi_p \Phi_i = \sum_{\alpha=1}^{N_p} \Pi^0_{i,\alpha}\,\varphi_\alpha
\end{equation*}
we obtain
\begin{equation*}
  \sum_{\alpha=1}^{N_p} \Pi^0_{i, \alpha}\,\underbrace{\int_E \varphi_\alpha\,\varphi_\beta}_{=: M_{\alpha,\beta}}
  = \int_E \Pi_p \Phi_i\,\varphi
  = \int_E \Phi\,\varphi
  \qquad\text{for $\beta = 1, \ldots, N_p$.}
\end{equation*}
The matrix $(\Pi^0_{i, \alpha})_{i, \alpha}$ is stored as \texttt{valueProjection}
in the VEM basis function set.


Now we turn to the computation of $\Pi_{p-1} \nabla \varphi_i$.
For $\alpha = 1, \ldots, N_{p-1}$, we have
\begin{equation*}
  \int_E \Pi_{p-1} \nabla \Phi_i\,m_\alpha
    = \int_E \nabla \Phi_i\,m_\alpha
    = \int_{\partial E} \Phi_i\,m_\alpha\,\nu - \int_E \Phi_i\,\nabla m_\alpha.
\end{equation*}
Since $\nabla m_\alpha \in \mathcal{P}_p( E )^d$, the following identity holds:
\begin{equation*}
  \int_E \Phi_i\,\nabla m_\alpha
    = \int_E \Pi_p \Phi_i\,\nabla m_\alpha
    = \sum_{\alpha=1}^{N_p} \Pi^0_{i, \alpha}\,\int_E \varphi_\alpha\,\nabla m_\alpha.
\end{equation*}

\end{document}
